# presentation
最新リビジョン：r56

・環境(サーバ)：さくらサーバ 　最新：2018/1/15 22:00
・サイトurl：
　作成ページ
  https://real-presen.sakura.ne.jp/presen_mk.php
  視聴ページ
  https://real-presen.sakura.ne.jp/presen_play.php?slide_group=5&slide_num=14


・DB情報：presentation_db_r5.sql 最新：2017/12/22

・画面遷移図_r2：
　https://www.dropbox.com/s/cyzalair3q6p5wu/%E7%94%BB%E9%9D%A2%E9%81%B7%E7%A7%BB%E5%9B%B3_r2.ppt?dl=0
 
 ・卒業企画書(卒業提出物)：★NEW 2018/01/18
　https://www.dropbox.com/s/bura7q6niv3k3uh/%E4%BC%81%E7%94%BB%E6%9B%B8%28%E5%8D%92%E6%A5%AD%E6%8F%90%E5%87%BA%E7%89%A9%29_r2.ppt?dl=0 


==================================================================================
■卒業作品提出作業～2018/1/18まで
※卒業最低限レベルまで仕上げる。他作業は一旦停止。

・さくらサーバアップロード【済】
・サイトにアクセスするたびに新規プレゼン登録ができるようにする【済】
⇒修正後：DBから情報を取得せず、初期UL画面を表示する
・スライドUL機能の修正(順番通りにアップロードできるようにする)【済】
⇒修正後：スライド配列をスライド名の番号順にソートしてDB登録する(例：スライド1,スライド2,スライド3,...）
・発表者名、プレゼン名修正【済】
・ULしたすべてのファイルが表示されない【済】
・audioタグ削除【済】


・視聴url生成機能
1)生成ボタン作成【済】
2)プレゼン再生ページ作成(presen_play.php)【済】

・バグ：アイコン登録バグ(各スライド頭に新規登録できない。登録時間がおかしい)【済】
⇒音声時間とrangersliderのstepが不一致のため発生。
⇒音声時間を小数点第2位で丸め処理＆rangersliderのstep=0.001に変更

・音声録音時のアイコン削除機能【済】
⇒ポップオーバーで削除する旨を記載

--------------------------------
■残件
・企画書
・過去に作成されたプレゼンurl一覧

・編集urlで編集可能にする
・ナビ：新規作成押下時に確認(新しいプレゼンを作成画面に遷移しますがよろしいですか？)
・リンク作成時にアラーム『視聴リンクを作成しました。お手元にコピーして・・・』
・各操作ボタンの整理
・編集リンク作成時にアラーム『編集リンクを作成しました。編集リンクをお手元にコピーしておいてください。現在のプレゼン内容を後で編集できるようになります。』
・その他バグ修正
・プレゼン名登録処理
・発表者名登録処理





==================================================================================
以下、おおまかな進捗を記載
【済】■ミニマム機能実装 (1.スライド、2.音声、3.同期) ⇒一旦完了。未完成部分は微調整部分で実装予定
【済】■発表者アイコン　編集機能(キャラメイク機能は保留、一旦画像をULする機能のみの実装にとどめる)

------------------------------------------------------
2017/12/29追記

下記の実装を一旦完了とします。
　1)ミニマム機能 (1.スライド登録、2.音声登録、3.音声とスライドの同期)
　2)発表者アイコンの登録、1)との同期機能(キャラメイク機能は保留、画像切り替えのみ)
　3)その他、各更新、削除機能
 
・一旦完了とはしましたが、テスト＆バグ修正＆微調整(コードの全体見直し、UX改善)が必要です。
・とはいえ、卒業最低条件のサービスインに向け、他画面の実装(ログイン画面など)や画面デザインの着手が必要です。
・1/18の卒業提出(商用サーバ公開？)にむけて下記優先順位で実装を進める予定です。

■予定(~2018/01/18)
  1.画面遷移図作成
  ⇒最小画面遷移図(1/18向け)＆画面デザイン作成　~12/31

　2.その他画面実装 1/2~1/6
 
　3.微調整(バグ改修＆後回しの実装箇所)※最悪保留のまま公開？ 1/7~14

　4.商用サーバ公開　1/15～1/18

==================================================================================

以下、進捗メモ
----------------------------------------------------------------------------------
【済】■ミニマム機能実装 (1.スライド、2.音声、3.同期) ⇒一旦完了。未完成部分は微調整部分で実装予定
-------------------------------------------------------------------------------------
1.スライド登録機能【完了】
【済】0)仮画面作成
【済】1)ファイルのアップロード
【済】2)DBに情報格納　(ajaxで投げ方がわからないので保留⇒画像名のみDBに保存、画像ファイルは/uploadフォルダに保存
【済】3)スライド表示
　　・画像ファイル名のみDB保存
　　・画像ファイル実態は/uploadに保存
【済】ajaxでのDB登録に修正予定　

2.音声登録機能【完了】
【済】0)画面作成
【済】1)音声録音(Web Audio API - record.jsを使用、録音部分は完成、現在のスライド枚数の表示機能追加)
　　【済】バグ：10s以上ULできない⇒upload_max_filesizeを2→100Mに変更、ファイルサイズ超過処理追加
【済】2)音声登録(1スライドごと、ajaxで音声データ投げる)　(ajax⇒voice_insert.phpに渡す)
3)DBに情報格納
　【済】・音声ファイル名のみDB保存
　【済】・音声ファイル実態は/upload_voiceに保存
  【済】スライドごとにaudioタグ表示(スライドごとに表示切り替え処理)
4)再生
　【済】・DB音声取得⇒表示処理(DBから情報取得、再生完了r15)
-------------------------

3.スライドと音声の同期制御
1)連続再生(スライドと音声を同期して同時再生する)
　【済】・再生/停止/一時停止ボタン
  【済】・再生/一時停止ボタン統合(youtubeのような操作を実装)
  【済】・audioタグシークバー同期処理との連動
  【済】・audioボタン一時無効処理(自動再生中)

----------------------------------------------------------
4.調整など
1)スライドDB登録方法修正(修正後、音声も)
⇒スライド1枚につき1レコード登録に変更
　【済】・スライド処理(slide_tableにslide_group、user_idを追加)
　【済】・音声処理処理(voice_tableにslide_group、user_idを追加)

2)スライダーバー(スライド全体)・・・音声or時間軸に同期
　【済】・スライダーバー設置(rangeslider.js)
　【済】・全体の音声時間取得処理(DBから取得する処理のみ)
  ・スライダーバー(全体)動作と同期
     【済】・自動再生同期
     【済】・スライド移動
     【済】・音声未登録時の処理　※ただし最後20ms前でスライダーがとまる⇒解消
     【済】・音声録音時の同期(全体の音声時間更新)
     【済】・スライダーバー(全体)を移動させたときと音声＆スライドの同期

【済】・スライド起動関数を関数化(2個ある)
【済】・自動再生時、音声未登録⇒音声ありスライドに切り替え時エラー⇒解消
　      Uncaught TypeError: Cannot read property 'currentTime' of null
【済】動作テスト＆バグ修正　
【済】スライド名＝ファイル名で登録


【済】3)音声ボタン統一(録音・再生)

4)スライド更新機能
 【済】・スライド一枚変更　(前スライドファイルは削除する)
 【済】・ファイル一括変更
　　　【済】・音声削除質問(一括削除、そのまま)⇒ダイアログで実装、音声削除実装済
  
5)音声更新機能
　・削除機能
　【済】・音声更新時の前回音声の削除処理
  【済】・音声削除処理(単体)
  　　　【済】・音声未登録時、非表示処理

6)初回スライドアップロードをドラッグ形式に変更(更新処理と切分けるため)
　【済】・ULボタン削除
　【済】・スライド＆音声データ未登録時の処理変更
 
 
------------------------------------------------------------------------------
【済】■発表者アイコン　編集機能(キャラメイク機能は保留、一旦画像をULする機能のみの実装にとどめる)
-------------------------------------------------------------------------------------

0)検証・・・nスライド目のx秒という単位で変更できるようにする
【済】・icon_list作成(フォーマット作成)
【済】・アイコン表示切り替え処理　//スライダーバー(全体)設置関数　.onslide中に記載
【済】・アイコンUL取得処理　　　function icon_ul_get(this_files)
　　⇒スライド番号ごとに配列作成したほうが良い？★保留★
【済】・アイコンリスト更新関数　function icon_list_mk(icon_name)
　　⇒一旦完成。(バグは都度修正)
  
【済】1)iconの切り替え表示処理
　⇒icon_back()、icon_front() スライダーバーとの同期
　⇒slickのオプションでspeed:0に変更でバグ消化★要テスト★
【済】2)iconアップロード処理(javascript側)
【済】3)テーブル作成【済】
【済】4)PHP送信＆DB登録処理【済】
【済】5)PHP受信＆初期表示【済】
　⇒PHPで配列作成＆追加⇒javascriptで受け取り
【済】6)初期処理確認【済】

7)iconリセットボタン
【済】・全削除
【済】・スライドごと削除
 　【済】icon_set()とicon_reset()重複部分あり。整理
　　【済】他更新処理(スライド、音声)にも適宜追加
【済】・単体削除
【済】⇒単体リセットボタン作成、javascriptでiconlist更新まで完成
【済】⇒DB更新処理

【済】スライド変更ボタン修正

---------------------------------------------------------------------------------
■画面遷移図(簡易的なものでOK)★ここから★
--------------------------------------------------------------------------------
・シナリオ
・画面遷移図
・画面デザイン(レイアウト)

---------------------------------------------------------------------------------
■微調整(後回しの実装箇所)
---------------------------------------------------------------------------------
・アイコンリセット(音声録音の際のスライドごとアイコン削除処理にて)バグあり★要調査
・頭出し処理は現状修正不可★保留★
・スライドinfoに秒数表示
・スライダーバー初期値0設定
・他処理PHPで配列作成＆追加⇒javascriptで受け取り

1)スライド更新頻度について【要質問】⇒issuesに記載はした。
　・スライド一枚削除処理★保留★
　⇒音声削除・スライド全更新
　・スライド一枚追加処理
　⇒スライド全更新

2)初回アップロード前、その他ボタン非表示⇒デザイン決定後実装予定★保留★
⇒スライド未アップロード時の音声録音無効処理(ここで吸収)

3)audioタグ修正⇒デザイン決定後着手予定★保留★

4)自動再生に妙な空き時間発生？target取得に時間がかかる？
⇒音声データの再生時間を指定してから再生するように変更後、発生しなくなった
⇒要テスト★保留★

5)音声データなしのとき
⇒デフォルト秒数入力欄の実装
⇒自動再生停止でよくない？★保留★

6)アップロード中の表示（ぐるぐる）
　グルグル周るアニメーションはただのアニメーションgifを
　まわしておけばいいので、簡単です。【え】

7)ファイルサイズ超過処理追加（スライド）

8)失敗時のエラー表示処理

9)スライド名変更処理


----------------------------------------------------------------------------------
・企画書のurl(最新版)：
  url: https://www.dropbox.com/s/6kr9ua1esrsr3zq/idea_28_tsukamoto_r6.ppt?dl=0

・計画(ガントチャート)：
  url: http://minna-de-gantt.com/gantt/main/?cid=Hf3wbfsWOC
　パスワード：gs28
